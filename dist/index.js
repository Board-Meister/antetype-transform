var n={INIT:"antetype.init",CLOSE:"antetype.close",DRAW:"antetype.draw",CALC:"antetype.calc",RECALC_FINISHED:"antetype.recalc.finished",MODULES:"antetype.modules",SETTINGS:"antetype.settings.definition",TYPE_DEFINITION:"antetype.layer.type.definition",FONTS_LOADED:"antetype.font.loaded"};var p="core",m="0.0.5",y=class{#t;#r=null;#e=null;static inject={marshal:"boardmeister/marshal",herald:"boardmeister/herald"};inject(a){this.#t=a}async loadModules(a,t){return(await this.#i()).loadModules(a,t)}register(a){let{registration:t}=a.detail;t[p]={load:async()=>(this.#r??=(await this.#a("core.js")).default,(r,e)=>this.#r({canvas:e,modules:r,herald:this.#t.herald})),version:m}}static subscriptions={[n.MODULES]:"register"};#a(a){return import(this.#t.marshal.getResourceUrl(this,a))}async#i(){return this.#e??=(await this.#a("helper.js")).default,new this.#e(this.#t.herald)}};var l=class{#t;#r;#e;#a;constructor(t,r,e){if(!t)throw new Error("[Antetype Illustrator] Provided canvas is empty");this.#t=t,this.#r=r,this.#e=this.#t.getContext("2d"),this.#a=e}registerEvents(){let t=this.#a.batch([{event:n.CLOSE,subscription:()=>{t()}},{event:n.DRAW,subscription:[{method:r=>{let{element:e}=r.detail;if(!Array.isArray(e.transforms))return;let i=e.transforms,o={rotate:this.rotate.bind(this),opacity:this.opacity.bind(this),filter:this.filter.bind(this)};this.#i(),i.forEach(s=>{let c=o[s.type]??null;typeof c=="function"&&c(s,e)})},priority:-255},{method:r=>{let{element:e}=r.detail;typeof e.transform=="object"&&this.#n()},priority:255}]}])}#i(){this.#e.save()}#n(){this.#e.restore()}rotate(t,r){let{start:{x:e,y:i},size:{w:o,h:s}}=r;this.#e.translate(e+o/2,i+s/2),this.#e.rotate(t.data.degree*Math.PI/180),this.#e.translate(-(e+o/2),-(i+s/2))}opacity(t){this.#e.globalAlpha=t.data.alpha}filter(t){this.#e.filter=t.data.filter}};var u="transform",h="0.0.4",d=class{#t;#r=null;static inject={marshal:"boardmeister/marshal",herald:"boardmeister/herald"};inject(t){this.#t=t}register(t){let{registration:r}=t.detail;r[u]={load:async()=>{if(!this.#r){let e=this.#t.marshal.getResourceUrl(this,"module.js");this.#r=(await import(e)).default}return(e,i)=>new this.#r(i,e,this.#t.herald)},version:h}}static subscriptions={[n.MODULES]:"register"}};export{u as ID,l as Transformer,h as VERSION};
