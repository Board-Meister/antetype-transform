var l={INIT:"antetype.init",CLOSE:"antetype.close",DRAW:"antetype.draw",CALC:"antetype.calc",RECALC_FINISHED:"antetype.recalc.finished",MODULES:"antetype.modules",SETTINGS:"antetype.settings.definition",TYPE_DEFINITION:"antetype.layer.type.definition",FONTS_LOADED:"antetype.font.loaded"};var u="core",d="0.0.5",h=class{#e;#a=null;#t=null;static inject={marshal:"boardmeister/marshal",herald:"boardmeister/herald"};inject(a){this.#e=a}async loadModules(a,t){return(await this.#n()).loadModules(a,t)}register(a){let{registration:t}=a.detail;t[u]={load:async()=>(this.#a??=(await this.#r("core.js")).default,(r,e)=>this.#a({canvas:e,modules:r,herald:this.#e.herald})),version:d}}static subscriptions={[l.MODULES]:"register"};#r(a){return import(this.#e.marshal.getResourceUrl(this,a))}async#n(){return this.#t??=(await this.#r("helper.js")).default,new this.#t(this.#e.herald)}};var o=class{#e;#a;#t;#r;constructor(t,r,e){if(!t)throw new Error("[Antetype Illustrator] Provided canvas is empty");this.#e=t,this.#a=r,this.#t=this.#e.getContext("2d"),this.#r=e}registerEvents(){let t=this.#r.batch([{event:l.CLOSE,subscription:()=>{t()}},{event:l.DRAW,subscription:[{method:r=>{let{element:e}=r.detail;if(!Array.isArray(e.transforms))return;let i=e.transforms,s={rotate:this.rotate.bind(this),opacity:this.opacity.bind(this),filter:this.filter.bind(this)};this.#n(),i.forEach(n=>{let c=s[n.type]??null;typeof c=="function"&&c(n,e)})},priority:-255},{method:r=>{let{element:e}=r.detail;typeof e.transform=="object"&&this.#i()},priority:255}]}])}#n(){this.#t.save()}#i(){this.#t.restore()}rotate(t,r){let{start:{x:e,y:i},size:{w:s,h:n}}=r;this.#t.translate(e+s/2,i+n/2),this.#t.rotate(t.data.degree*Math.PI/180),this.#t.translate(-(e+s/2),-(i+n/2))}opacity(t){this.#t.globalAlpha=t.data.alpha}filter(t){this.#t.filter=t.data.filter}};export{o as default};
